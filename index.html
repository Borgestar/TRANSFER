<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Transfer Pro - Gest√£o</title>

    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#1e3c72">
    <link rel="apple-touch-icon" href="icon.png">

    <style>
        /* --- ESTILOS GERAIS (PREMIUM LOOK) --- */
        :root {
            --primary: #1e3c72;
            --primary-gradient: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            --green: #27ae60;
            --red: #e74c3c;
            --bg: #f4f7f6;
            --card: #ffffff;
            --text: #333;
            --text-light: #7f8c8d;
        }

        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif; background: var(--bg); padding: 15px; max-width: 550px; margin: auto; color: var(--text); padding-bottom: 40px; }
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }

        /* --- 1. CABE√áALHO (SALDO) --- */
        .header-card {
            background: var(--primary-gradient);
            color: white;
            padding: 25px 20px;
            border-radius: 20px;
            text-align: center;
            box-shadow: 0 10px 20px rgba(30, 60, 114, 0.2);
            margin-bottom: 25px;
            position: relative;
            overflow: hidden;
        }
        /* Efeito de brilho no fundo */
        .header-card::after { content: ''; position: absolute; top: -50%; left: -50%; width: 200%; height: 200%; background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, transparent 60%); pointer-events: none; }

        .label-total { font-size: 11px; text-transform: uppercase; letter-spacing: 2px; opacity: 0.8; margin-bottom: 5px; }
        .valor-total { font-size: 42px; font-weight: 700; margin-bottom: 15px; text-shadow: 0 2px 4px rgba(0,0,0,0.2); }
        
        .resumo-grid { display: grid; grid-template-columns: 1fr 1px 1fr; gap: 10px; background: rgba(0,0,0,0.2); padding: 12px; border-radius: 12px; align-items: center; }
        .resumo-item span { display: block; }
        .resumo-label { font-size: 10px; opacity: 0.9; margin-bottom: 2px; }
        .resumo-val { font-size: 16px; font-weight: 600; }
        .divider { background: rgba(255,255,255,0.2); height: 30px; }

        /* --- 2. FORMUL√ÅRIO (INPUTS) --- */
        .form-card { background: var(--card); padding: 20px; border-radius: 20px; box-shadow: 0 4px 15px rgba(0,0,0,0.05); margin-bottom: 25px; }
        
        .input-row { display: flex; gap: 12px; margin-bottom: 12px; }
        .input-group { flex: 1; }
        
        label { display: block; font-size: 11px; color: var(--text-light); font-weight: 600; margin-bottom: 5px; text-transform: uppercase; }
        input { width: 100%; padding: 14px; border: 1px solid #e0e0e0; border-radius: 10px; font-size: 16px; background: #fafafa; transition: 0.3s; outline: none; }
        input:focus { border-color: var(--primary); background: #fff; box-shadow: 0 0 0 3px rgba(30, 60, 114, 0.1); }

        .btn-row { display: flex; gap: 10px; margin-top: 5px; }
        .btn-action { flex: 1; padding: 16px; border: none; border-radius: 12px; font-size: 14px; font-weight: bold; color: white; cursor: pointer; display: flex; align-items: center; justify-content: center; gap: 8px; transition: transform 0.1s; box-shadow: 0 4px 6px rgba(0,0,0,0.1); }
        .btn-action:active { transform: scale(0.97); }
        .btn-green { background: var(--green); }
        .btn-red { background: var(--red); }

        /* --- 3. LISTA (DI√ÅRIO) --- */
        .section-title { font-size: 14px; color: var(--text-light); font-weight: 700; text-transform: uppercase; margin-bottom: 15px; margin-left: 5px; letter-spacing: 0.5px; }
        
        .day-card { background: var(--card); border-radius: 16px; margin-bottom: 20px; box-shadow: 0 2px 10px rgba(0,0,0,0.03); overflow: hidden; animation: fadeIn 0.4s ease; border: 1px solid rgba(0,0,0,0.03); }
        
        .day-header { background: #f8f9fa; padding: 12px 15px; border-bottom: 1px solid #eee; display: flex; justify-content: space-between; align-items: center; }
        .day-date { font-weight: 700; color: var(--primary); font-size: 15px; }
        .day-week { font-weight: 400; color: var(--text-light); font-size: 12px; margin-left: 5px; }
        .day-balance { font-weight: 700; font-size: 14px; }
        
        .day-stats { padding: 8px 15px; font-size: 12px; display: flex; gap: 15px; color: var(--text-light); border-bottom: 1px dashed #eee; background: #fff; }
        
        .txn-list { list-style: none; padding: 0; margin: 0; }
        .txn-item { display: flex; justify-content: space-between; align-items: center; padding: 12px 15px; border-bottom: 1px solid #f1f1f1; position: relative; }
        .txn-item:last-child { border-bottom: none; }
        
        /* Indicador colorido na esquerda */
        .txn-indicator { position: absolute; left: 0; top: 0; bottom: 0; width: 4px; }
        
        .txn-info { padding-left: 8px; }
        .txn-desc { font-weight: 600; font-size: 15px; display: block; color: var(--text); }
        .txn-sub { font-size: 12px; color: var(--text-light); margin-top: 3px; display: block; }
        
        .txn-actions { display: flex; align-items: center; gap: 10px; }
        .txn-val { font-weight: 700; font-size: 15px; }
        .btn-del { background: none; border: none; color: #ccc; font-size: 18px; padding: 5px; cursor: pointer; }
        .btn-del:hover { color: var(--red); }

        /* --- 4. √ÅREA DE FERRAMENTAS (BACKUP) --- */
        .tools-section { margin-top: 30px; background: #fff; padding: 20px; border-radius: 16px; border: 1px solid #e0e0e0; }
        .tools-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }
        
        .btn-tool { background: #fff; border: 2px solid #e0e0e0; color: var(--text-light); padding: 12px; border-radius: 10px; font-size: 13px; font-weight: 600; cursor: pointer; display: flex; flex-direction: column; align-items: center; gap: 5px; transition: 0.2s; }
        .btn-tool span { font-size: 18px; }
        .btn-tool:hover { border-color: var(--primary); color: var(--primary); background: #f0f4ff; }

        /* --- 5. RODAP√â (FOOTER) --- */
        .app-footer { margin-top: 40px; background: #222; color: #888; padding: 30px 20px; border-radius: 20px 20px 0 0; text-align: center; }
        .footer-brand { color: #fff; font-size: 14px; font-weight: bold; margin-bottom: 5px; letter-spacing: 1px; }
        .footer-link { display: inline-block; background: rgba(255,255,255,0.1); color: #fff; text-decoration: none; padding: 10px 20px; border-radius: 50px; margin-top: 15px; font-weight: 600; font-size: 14px; transition: 0.3s; }
        .footer-link:hover { background: var(--green); transform: translateY(-2px); }

        /* Aux */
        .color-green { color: var(--green); }
        .color-red { color: var(--red); }
        #fileInput { display: none; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

    </style>
</head>
<body>

    <div class="header-card">
        <div class="label-total">LUCRO L√çQUIDO TOTAL</div>
        <div id="saldo-total" class="valor-total">R$ 0,00</div>
        
        <div class="resumo-grid">
            <div class="resumo-item">
                <span class="resumo-label">ENTRADAS</span>
                <span id="tot-ent" class="resumo-val color-green">R$ 0,00</span>
            </div>
            <div class="divider"></div>
            <div class="resumo-item">
                <span class="resumo-label">SA√çDAS</span>
                <span id="tot-sai" class="resumo-val color-red">R$ 0,00</span>
            </div>
        </div>
    </div>

    <div class="form-card">
        <div class="input-row">
            <div class="input-group">
                <label>Data</label>
                <input type="date" id="data">
            </div>
            <div class="input-group">
                <label>KM (Opcional)</label>
                <input type="number" id="km" placeholder="0" inputmode="decimal">
            </div>
        </div>

        <label>Descri√ß√£o</label>
        <input type="text" id="desc" placeholder="Ex: Corrida Barra, Gasolina...">

        <label>Valor (R$)</label>
        <input type="number" id="valor" placeholder="0,00" inputmode="decimal" step="0.01">

        <div class="btn-row">
            <button class="btn-action btn-green" onclick="lancar('entrada')">
                <span>üí∞</span> RECEBI
            </button>
            <button class="btn-action btn-red" onclick="lancar('saida')">
                <span>üí∏</span> GASTEI
            </button>
        </div>
    </div>

    <div class="section-title">Hist√≥rico de Atividades</div>
    <div id="container-historico">
        </div>

    <div class="section-title" style="margin-top: 30px;">Ferramentas do Sistema</div>
    <div class="tools-section">
        <div class="tools-grid">
            <button class="btn-tool" onclick="baixarBackup()">
                <span>‚òÅÔ∏è</span> Baixar Backup
            </button>
            <button class="btn-tool" onclick="document.getElementById('fileInput').click()">
                <span>üìÇ</span> Restaurar Dados
            </button>
        </div>
        <input type="file" id="fileInput" onchange="restaurarBackup(this)">
        <p style="text-align:center; font-size:10px; color:#999; margin-top:10px">
            Salve seus dados periodicamente para n√£o perder.
        </p>
    </div>

    <footer class="app-footer">
        <div class="footer-brand">LUCAS BORGES</div>
        <div style="font-size: 11px; opacity: 0.6;">SISTEMA DE GEST√ÉO DE TRANSFER</div>
        
        <a href="tel:5521979779313" class="footer-link">
            üìû Falar com Suporte (21) 979779313
        </a>
        
        <div style="margin-top: 20px; font-size: 10px; color: #555;">
            Vers√£o 7.0 Ultimate &bull; Todos os direitos reservados
        </div>
    </footer>

    <script>
        // --- INICIALIZA√á√ÉO ---
        document.getElementById('data').valueAsDate = new Date();
        // Mantendo o mesmo nome do banco para voc√™ n√£o perder dados da V6
        let lista = JSON.parse(localStorage.getItem('caderno_lucas_v6')) || []; 
        atualizarTela();

        // --- L√ìGICA ---
        function lancar(tipo) {
            let data = document.getElementById('data').value;
            let desc = document.getElementById('desc').value;
            let valor = parseFloat(document.getElementById('valor').value);
            let km = parseFloat(document.getElementById('km').value) || 0;

            if (!desc || !valor) { alert("Preencha descri√ß√£o e valor!"); return; }

            lista.unshift({
                id: Date.now(), data, desc, valor, tipo, km
            });

            salvar();
            
            document.getElementById('desc').value = '';
            document.getElementById('valor').value = '';
            document.getElementById('km').value = '';
            document.getElementById('desc').focus();
        }

        function atualizarTela() {
            let container = document.getElementById('container-historico');
            container.innerHTML = '';
            let totalMes = 0, entMes = 0, saiMes = 0;
            let grupos = {};
            
            // Agrupar
            lista.forEach(item => {
                if(item.tipo === 'entrada') { totalMes += item.valor; entMes += item.valor; }
                else { totalMes -= item.valor; saiMes += item.valor; }
                if (!grupos[item.data]) grupos[item.data] = [];
                grupos[item.data].push(item);
            });

            // Ordenar Datas
            let datasOrdenadas = Object.keys(grupos).sort().reverse();

            // Gerar HTML
            datasOrdenadas.forEach(data => {
                let itens = grupos[data];
                let saldoDia = 0, entDia = 0, saiDia = 0, kmDia = 0;
                let listaHTML = '';

                itens.forEach(t => {
                    if (t.tipo === 'entrada') { saldoDia += t.valor; entDia += t.valor; kmDia += t.km; }
                    else { saldoDia -= t.valor; saiDia += t.valor; }

                    let corVal = t.tipo === 'entrada' ? 'color-green' : 'color-red';
                    let sinal = t.tipo === 'entrada' ? '+' : '-';
                    let borderCor = t.tipo === 'entrada' ? '#27ae60' : '#e74c3c';
                    
                    listaHTML += `
                        <li class="txn-item">
                            <div class="txn-indicator" style="background:${borderCor}"></div>
                            <div class="txn-info">
                                <span class="txn-desc">${t.desc}</span>
                                <span class="txn-sub">${t.km ? 'üö¶ ' + t.km + ' km' : 'Geral'}</span>
                            </div>
                            <div class="txn-actions">
                                <span class="txn-val ${corVal}">${sinal}${t.valor.toFixed(2)}</span>
                                <button class="btn-del" onclick="apagar(${t.id})">&times;</button>
                            </div>
                        </li>
                    `;
                });

                let [ano, mes, dia] = data.split('-');
                let dataObj = new Date(ano, mes-1, dia);
                let diasSemana = ['Domingo', 'Segunda', 'Ter√ßa', 'Quarta', 'Quinta', 'Sexta', 'S√°bado'];
                let diaSemana = diasSemana[dataObj.getDay()];
                let corSaldo = saldoDia >= 0 ? 'color-green' : 'color-red';

                container.innerHTML += `
                    <div class="day-card">
                        <div class="day-header">
                            <div>
                                <span class="day-date">${dia}/${mes}</span>
                                <span class="day-week">${diaSemana}</span>
                            </div>
                            <div class="day-balance ${corSaldo}">R$ ${saldoDia.toFixed(2)}</div>
                        </div>
                        <div class="day-stats">
                            <span>Entrou: <b class="color-green">${entDia.toFixed(2)}</b></span>
                            <span>Saiu: <b class="color-red">${saiDia.toFixed(2)}</b></span>
                            <span>Rodou: <b>${kmDia.toFixed(0)} km</b></span>
                        </div>
                        <ul class="txn-list">${listaHTML}</ul>
                    </div>
                `;
            });

            document.getElementById('saldo-total').innerText = 'R$ ' + totalMes.toFixed(2);
            document.getElementById('tot-ent').innerText = 'R$ ' + entMes.toFixed(2);
            document.getElementById('tot-sai').innerText = 'R$ ' + saiMes.toFixed(2);
        }

        function salvar() {
            localStorage.setItem('caderno_lucas_v6', JSON.stringify(lista));
            atualizarTela();
        }

        function apagar(id) {
            if(confirm("Apagar registro?")) {
                lista = lista.filter(i => i.id !== id);
                salvar();
            }
        }

        function baixarBackup() {
            const blob = new Blob([JSON.stringify(lista)], { type: "application/json" });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = "backup_lucas_transfer.json";
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
        }

        function restaurarBackup(input) {
            const file = input.files[0];
            if (!file) return;
            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    lista = JSON.parse(e.target.result);
                    salvar();
                    alert("Dados restaurados com sucesso!");
                } catch(err) { alert("Arquivo inv√°lido"); }
            };
            reader.readAsText(file);
        }
    </script>
</body>
</html>
